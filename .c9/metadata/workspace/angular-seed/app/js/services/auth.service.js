{"filter":false,"title":"auth.service.js","tooltip":"/angular-seed/app/js/services/auth.service.js","ace":{"folds":[],"scrolltop":106.5,"scrollleft":0,"selection":{"start":{"row":31,"column":24},"end":{"row":31,"column":56},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":6,"state":"start","mode":"ace/mode/javascript"}},"hash":"a497a0a7acae2f074ffb009fae33f7dbf0d5bf06","undoManager":{"mark":2,"position":2,"stack":[[{"start":{"row":0,"column":0},"end":{"row":91,"column":5},"action":"insert","lines":["(function() {","","    'use strict';","","    mbApp.services.factory('AuthService', ['$rootScope', '$cookies', 'AppConfig', AuthService]);","","    var utils = mbApp.utils.eth;","","    function AuthService($rootScope, $cookies, AppConfig) {","","        return {","            login: login,","            autologin: autologin,","            logout: logout,","","            isAnonymous: isAnonymous,","            isAuthorized: isAuthorized,","            isAuthentificated: isAuthentificated,","            ","            isOwner: isOwner,","            ","            getAddress: getAddress,","            getSeedHash: getSeedHash,","            getClientInfo: getClientInfo","        };","","        function login(seed) {","            return _.isEmpty(seed) ? null : autologin(utils.seedToAuth(seed));","        }","","        function autologin(auth) {","            $cookies.put('auth:seedHash', auth.seedHash);","            $cookies.put('auth:address', auth.address);","","            $rootScope.$broadcast('auth:login', auth);","            ","            return auth.address;","        }","","        function logout() {","            $cookies.remove('auth:seedHash')","            $cookies.remove('auth:address');","","            $rootScope.$broadcast('auth:logout');","        }","","        function isAuthorized() {","            ","        }","","        function isAdmin() {","            return false;","        }","","        function isSuperAdmin() {","            return getAddress() === AppConfig.SU_ADDRESS;","        }","","        function isOwner(address) {","            return _.isEqual(getAddress().toUpperCase(), address.toUpperCase());","        }","","        function isAnonymous() {","            return !getAddress();","        }","","        function isAuthentificated() {","            return !isAnonymous();","        }","","        function getAddress() {","            return $cookies.get('auth:address');","        }","","        function getSeedHash() {","            return $cookies.get('auth:seedHash');","        }","","        function getClientInfo() {","            var result = {};","","            var address = getAddress();","            if (address) {","                result.address = address;","                result.seedHash = getSeedHash();","            }","","            return result;","        }","    }","","})();"],"id":1}],[{"start":{"row":4,"column":5},"end":{"row":4,"column":6},"action":"remove","lines":["b"],"id":2},{"start":{"row":4,"column":5},"end":{"row":4,"column":6},"action":"insert","lines":["y"]}],[{"start":{"row":6,"column":17},"end":{"row":6,"column":18},"action":"remove","lines":["b"],"id":3},{"start":{"row":6,"column":17},"end":{"row":6,"column":18},"action":"insert","lines":["y"]}]]},"timestamp":1449157508209}